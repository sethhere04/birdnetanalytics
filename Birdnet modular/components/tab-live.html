<!-- Live Tab Content -->
<div class="section">
    <h2>‚ö° Live Detections</h2>
    
    <!-- Live Status -->
    <div id="live-status" class="info-box info-box-info">
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <div class="spinner" style="width: 20px; height: 20px; border-width: 2px;"></div>
            <span>Connecting to live feed...</span>
        </div>
    </div>
    
    <!-- Live Controls -->
    <div style="display: flex; justify-content: space-between; align-items: center; margin: 1rem 0;">
        <div style="display: flex; gap: 0.5rem;">
            <button id="live-start" class="btn btn-primary" onclick="typeof BirdNET.live !== 'undefined' && BirdNET.live.start && BirdNET.live.start()">
                ‚ñ∂Ô∏è Start Listening
            </button>
            <button id="live-stop" class="btn btn-secondary" onclick="typeof BirdNET.live !== 'undefined' && BirdNET.live.stop && BirdNET.live.stop()" style="display: none;">
                ‚è∏Ô∏è Pause
            </button>
        </div>
        <div style="display: flex; gap: 1rem; align-items: center;">
            <div style="display: flex; align-items: center; gap: 0.5rem;">
                <div id="live-indicator" style="width: 10px; height: 10px; border-radius: 50%; background: #6b7280;"></div>
                <span id="live-indicator-text" style="font-size: 0.875rem; color: #6b7280;">Offline</span>
            </div>
            <div style="font-size: 0.875rem; color: #6b7280;">
                <span id="live-detection-count">0</span> detections
            </div>
        </div>
    </div>
    
    <!-- Live Detections Feed -->
    <div id="live-detections" style="margin-top: 1rem;">
        <div class="empty-state">
            <div class="empty-state-icon">üëÇ</div>
            <div class="empty-state-title">Listening for Birds</div>
            <div class="empty-state-description">Live detections will appear here as they happen</div>
        </div>
    </div>
</div>

<!-- Live Activity Chart -->
<div class="section">
    <h2>üìä Live Activity</h2>
    <p style="color: #6b7280; margin-bottom: 1rem;">
        Real-time detection activity over the last hour
    </p>
    <div style="background: white; padding: 1.5rem; border-radius: 8px; border: 1px solid #e5e7eb;">
        <canvas id="live-chart" style="max-height: 300px;"></canvas>
    </div>
</div>

<!-- Current Conditions -->
<div class="section">
    <h2>üå§Ô∏è Current Conditions</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e5e7eb; text-align: center;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üå°Ô∏è</div>
            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Temperature</div>
            <div id="live-temperature" style="font-size: 1.5rem; font-weight: 700; color: #1f2937;">--¬∞F</div>
        </div>
        <div style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e5e7eb; text-align: center;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üí®</div>
            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Wind</div>
            <div id="live-wind" style="font-size: 1.5rem; font-weight: 700; color: #1f2937;">-- mph</div>
        </div>
        <div style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e5e7eb; text-align: center;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚òÅÔ∏è</div>
            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Conditions</div>
            <div id="live-conditions" style="font-size: 1rem; font-weight: 600; color: #1f2937;">Loading...</div>
        </div>
        <div style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e5e7eb; text-align: center;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üïê</div>
            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem;">Local Time</div>
            <div id="live-time" style="font-size: 1.5rem; font-weight: 700; color: #1f2937;">--:--</div>
        </div>
    </div>
</div>

<!-- Live Settings -->
<div class="section">
    <h2>‚öôÔ∏è Live Detection Settings</h2>
    <div style="background: white; padding: 1.5rem; border-radius: 8px; border: 1px solid #e5e7eb;">
        <div style="display: grid; gap: 1.5rem;">
            <!-- Confidence Threshold -->
            <div>
                <label style="display: block; font-weight: 500; margin-bottom: 0.5rem;">
                    Minimum Confidence
                    <span style="font-weight: 400; color: #6b7280; font-size: 0.875rem;">(only show detections above this threshold)</span>
                </label>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <input type="range" id="live-confidence-threshold" min="0" max="100" value="50" 
                           style="flex: 1;" 
                           oninput="document.getElementById('live-confidence-value').textContent = this.value + '%'">
                    <span id="live-confidence-value" style="min-width: 50px; font-weight: 600;">50%</span>
                </div>
            </div>
            
            <!-- Sound Notifications -->
            <div>
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="checkbox" id="live-sound-notifications" style="width: 18px; height: 18px;">
                    <span style="font-weight: 500;">Play sound on new detection</span>
                </label>
                <p style="color: #6b7280; font-size: 0.875rem; margin: 0.5rem 0 0 1.5rem;">
                    Get audio alerts when new birds are detected
                </p>
            </div>
            
            <!-- Desktop Notifications -->
            <div>
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="checkbox" id="live-desktop-notifications" style="width: 18px; height: 18px;">
                    <span style="font-weight: 500;">Desktop notifications</span>
                </label>
                <p style="color: #6b7280; font-size: 0.875rem; margin: 0.5rem 0 0 1.5rem;">
                    Show browser notifications for high-confidence detections
                </p>
            </div>
            
            <!-- Auto-refresh -->
            <div>
                <label style="display: block; font-weight: 500; margin-bottom: 0.5rem;">
                    Update Frequency
                </label>
                <select id="live-refresh-rate" style="padding: 0.5rem; border: 1px solid #e5e7eb; border-radius: 6px; width: 200px;">
                    <option value="1000">Every 1 second</option>
                    <option value="2000" selected>Every 2 seconds</option>
                    <option value="5000">Every 5 seconds</option>
                    <option value="10000">Every 10 seconds</option>
                </select>
            </div>
        </div>
    </div>
</div>

<!-- Recent High-Confidence Detections -->
<div class="section">
    <h2>‚≠ê Recent High-Confidence Detections</h2>
    <p style="color: #6b7280; margin-bottom: 1rem;">
        Detections with confidence above 80% from the last hour
    </p>
    <div id="live-high-confidence" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
        <div class="empty-state-grid">
            <div style="text-align: center; padding: 2rem; color: #6b7280;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">üéØ</div>
                <div>No high-confidence detections yet</div>
            </div>
        </div>
    </div>
</div>

<script>
// Initialize live time display
function updateLiveTime() {
    const timeElement = document.getElementById('live-time');
    if (timeElement) {
        const now = new Date();
        timeElement.textContent = now.toLocaleTimeString();
    }
}

// Update time every second
setInterval(updateLiveTime, 1000);
updateLiveTime();

// Initialize live indicator as offline
const indicator = document.getElementById('live-indicator');
const indicatorText = document.getElementById('live-indicator-text');
if (indicator) {
    indicator.style.background = '#6b7280';
}
if (indicatorText) {
    indicatorText.textContent = 'Offline';
}
</script>